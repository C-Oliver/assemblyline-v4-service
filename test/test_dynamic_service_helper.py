import pytest
import os

SERVICE_CONFIG_NAME = "service_manifest.yml"
TEMP_SERVICE_CONFIG_PATH = os.path.join("/tmp", SERVICE_CONFIG_NAME)


@pytest.fixture
def dummy_task_class():
    class DummyTask:
        def __init__(self):
            self.supplementary = []
            self.extracted = []
    yield DummyTask


@pytest.fixture
def dummy_event_class():
    class DummyEvent:
        def __init__(self, item):
            self.timestamp = item["timestamp"]
    yield DummyEvent


@pytest.fixture
def dummy_request_class(dummy_task_class):
    class DummyRequest(dict):
        def __init__(self):
            super(DummyRequest, self).__init__()
            self.task = dummy_task_class()

        def add_supplementary(self, path, name, description):
            self.task.supplementary.append({"path": path, "name": name, "description": description})

        def add_extracted(self, path, name, description):
            self.task.extracted.append({"path": path, "name": name, "description": description})

    yield DummyRequest


def check_artifact_equality(this, that):
    if this.name == that.name and this.path == that.path and this.description == that.description \
            and this.to_be_extracted == that.to_be_extracted:
        return True
    else:
        return False


def check_section_equality(this, that) -> bool:
    # Recursive method to check equality of result section and nested sections

    # Heuristics also need their own equality checks
    if this.heuristic and that.heuristic:
        heuristic_equality = this.heuristic.definition.attack_id == that.heuristic.definition.attack_id and \
                             this.heuristic.definition.classification == that.heuristic.definition.classification and \
                             this.heuristic.definition.description == that.heuristic.definition.description and \
                             this.heuristic.definition.filetype == that.heuristic.definition.filetype and \
                             this.heuristic.definition.heur_id == that.heuristic.definition.heur_id and \
                             this.heuristic.definition.id == that.heuristic.definition.id and \
                             this.heuristic.definition.max_score == that.heuristic.definition.max_score and \
                             this.heuristic.definition.name == that.heuristic.definition.name and \
                             this.heuristic.definition.score == that.heuristic.definition.score and \
                             this.heuristic.definition.signature_score_map == \
                             that.heuristic.definition.signature_score_map

        result_heuristic_equality = heuristic_equality and \
                                    this.heuristic.attack_ids == that.heuristic.attack_ids and \
                                    this.heuristic.frequency == that.heuristic.frequency and \
                                    this.heuristic.heur_id == that.heuristic.heur_id and \
                                    this.heuristic.score == that.heuristic.score and \
                                    this.heuristic.score_map == that.heuristic.score_map and \
                                    this.heuristic.signatures == that.heuristic.signatures

    elif not this.heuristic and not that.heuristic:
        result_heuristic_equality = True
    else:
        result_heuristic_equality = False

    # Assuming we are given the "root section" at all times, it is safe to say that we don't need to confirm parent
    current_section_equality = result_heuristic_equality and \
                               this.body == that.body and \
                               this.body_format == that.body_format and \
                               this.classification == that.classification and \
                               this.depth == that.depth and \
                               len(this.subsections) == len(that.subsections) and \
                               this.title_text == that.title_text

    if not current_section_equality:
        return False

    for index, subsection in enumerate(this.subsections):
        subsection_equality = check_section_equality(subsection, that.subsections[index])
        if not subsection_equality:
            return False

    return True


def setup_module():
    if not os.path.exists(TEMP_SERVICE_CONFIG_PATH):
        open_manifest = open(TEMP_SERVICE_CONFIG_PATH, "w")
        open_manifest.write("name: Sample\nversion: sample\ndocker_config: \n  image: sample\nheuristics:\n  - heur_id: 17\n    name: blah\n    description: blah\n    filetype: '*'\n    score: 250")


def teardown_module():
    if os.path.exists(TEMP_SERVICE_CONFIG_PATH):
        os.remove(TEMP_SERVICE_CONFIG_PATH)


class TestEvent:
    @staticmethod
    @pytest.mark.parametrize("pid, image, timestamp, guid",
        [
            (None, None, None, None,),
            (1, 1, "blah", "blah",),
        ]
    )
    def test_init(pid, image, timestamp, guid):
        from assemblyline_v4_service.common.dynamic_service_helper import Event
        e = Event(pid, image, timestamp, guid)
        assert e.pid == pid
        assert e.image == image
        assert e.timestamp == timestamp
        assert e.guid == guid

    @staticmethod
    @pytest.mark.parametrize("pid, image, timestamp, guid, expected_result",
        [
            (None, None, None, None,
                {"image": None, "pid": None, "timestamp": None, "guid": None}),
            (1, "blah", 1.0, "blah",
                {"image": "blah", "pid": 1, "timestamp": 1.0, "guid": "blah"}),
        ]
    )
    def test_convert_event_to_dict(pid, image, timestamp, guid, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import Event
        e = Event(pid=pid, image=image, timestamp=timestamp, guid=guid)
        actual_result = e.convert_event_to_dict()
        assert actual_result == expected_result

    @staticmethod
    @pytest.mark.parametrize("path, expected_result",
        [
            ("blah", "x86"),
            ("C:\\program files\\blah", "x86"),
            ("C:\\program files (x86)\\blah", "x86_64"),
            ("C:\\syswow64\\blah", "x86_64"),
        ]
    )
    def test_determine_arch(path, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import Event
        e = Event(pid=1, image=path, timestamp=0, guid="blah")
        actual_result = e._determine_arch(path)
        assert actual_result == expected_result

    @staticmethod
    @pytest.mark.parametrize("path, rule, expected_result",
        [
            ("blah", {"pattern": "", "replacement": ""}, "blah"),
            ("blah", {"pattern": "ah", "replacement": "ue"}, "blah"),
            ("blah", {"pattern": "bl", "replacement": "y"}, "yah"),
        ]
    )
    def test_pattern_substitution(path, rule, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import Event
        e = Event(pid=1, image=path, timestamp=0, guid="blah")
        actual_result = e._pattern_substitution(path, rule)
        assert actual_result == expected_result

    @staticmethod
    @pytest.mark.parametrize("path, rule, expected_result",
         [
             ("blah", {"regex": "", "replacement": ""}, "blah"),
             ("blah", {"regex": "bl*ah", "replacement": "bl"}, "blah"),
             ("blah", {"regex": "\\bl*ah", "replacement": "bl"}, "blah"),
             ("blaah", {"regex": "bl*ah", "replacement": "blue"}, "blue"),
         ]
     )
    def test_regex_substitution(path, rule, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import Event
        e = Event(pid=1, image=path, timestamp=0, guid="blah")
        actual_result = e._regex_substitution(path, rule)
        assert actual_result == expected_result

    @staticmethod
    @pytest.mark.parametrize("path, arch, expected_result",
        [
            ("blah", None, "blah"),
            ("C:\\Program Files\\Word.exe", None, "?pf86\\word.exe"),
            ("C:\\Program Files (x86)\\Word.exe", None, "?pf86\\word.exe"),
            ("C:\\Program Files (x86)\\Word.exe", "x86_64", "?pf86\\word.exe"),
            ("C:\\Windows\\System32\\Word.exe", None, "?sys32\\word.exe"),
            ("C:\\Windows\\SysWow64\\Word.exe", None, "?sys32\\word.exe"),
            ("C:\\Windows\\SysWow64\\Word.exe", "x86", "?win\\syswow64\\word.exe"),
            ("C:\\Windows\\SysWow64\\Word.exe", "x86_64", "?sys32\\word.exe"),
            ("C:\\Users\\buddy\\AppData\\Local\\Temp\\Word.exe", None, "?usrtmp\\word.exe"),
            ("C:\\Users\\buddy\\Word.exe", None, "?usr\\word.exe"),
        ]
    )
    def test_normalize_path(path, arch, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import Event
        e = Event(pid=1, image=path, timestamp=0, guid="blah")
        actual_result = e._normalize_path(path, arch)
        assert actual_result == expected_result


class TestProcessEvent:
    @staticmethod
    @pytest.mark.parametrize("pid, ppid, image, command_line, timestamp",
        [
            (None, None, None, None, None),
            (1, 1, "blah", "blah", 1.0),
        ]
    )
    def test_init(pid, ppid, image, command_line, timestamp):
        from assemblyline_v4_service.common.dynamic_service_helper import ProcessEvent
        p = ProcessEvent(pid=pid, ppid=ppid, image=image, command_line=command_line, timestamp=timestamp)
        assert p.pid == pid
        assert p.ppid == ppid
        assert p.image == image
        assert p.command_line == command_line
        assert p.timestamp == timestamp


class TestNetworkEvent:
    @staticmethod
    @pytest.mark.parametrize("protocol, src_ip, src_port, domain, dest_ip, dest_port, pid, timestamp",
        [
            (None, None, None, None, None, None, None, None),
            ("blah", "blah", 1, "blah", "blah", 1, 1, 1.0),
        ]
    )
    def test_init(protocol, src_ip, src_port, domain, dest_ip, dest_port, pid, timestamp):
        from assemblyline_v4_service.common.dynamic_service_helper import NetworkEvent
        n = NetworkEvent(protocol=protocol, src_ip=src_ip, src_port=src_port, domain=domain, dest_ip=dest_ip, dest_port=dest_port, pid=pid, timestamp=timestamp)
        assert n.protocol == protocol
        assert n.src_port == src_port
        assert n.domain == domain
        assert n.dest_ip == dest_ip
        assert n.dest_port == dest_port
        assert n.pid == pid
        assert n.timestamp == timestamp


class TestArtifact:
    @staticmethod
    @pytest.mark.parametrize("name, path, description, to_be_extracted",
        [
            (None, None, None, None),
            ("blah", "blah", "blah", True),
            ("blah", "blah", "blah", False),
        ]
    )
    def test_init(name, path, description, to_be_extracted):
        from assemblyline_v4_service.common.dynamic_service_helper import Artifact
        if any(item is None for item in [name, path, description, to_be_extracted]):
            with pytest.raises(Exception):
                Artifact(name=name, path=path, description=description, to_be_extracted=to_be_extracted)
            return
        a = Artifact(name=name, path=path, description=description, to_be_extracted=to_be_extracted)
        assert a.name == name
        assert a.path == path
        assert a.description == description
        assert a.to_be_extracted == to_be_extracted


class TestEvents:
    @staticmethod
    @pytest.mark.parametrize("events, expected_events, expected_sorted_events, expected_process_events, expected_network_events", [([], [], [], [], [])])
    def test_init(events, expected_events, expected_sorted_events, expected_process_events, expected_network_events):
        from assemblyline_v4_service.common.dynamic_service_helper import Events
        e = Events(events=events)
        assert e.events == expected_events
        assert e.sorted_events == expected_sorted_events
        assert e.process_events == expected_process_events
        assert e.network_events == expected_network_events

    @staticmethod
    @pytest.mark.parametrize("events, validated_events_num",
        [
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}], 1),
            ([{"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}], 1),
            ([{}], 0),
        ]
    )
    def test_validate_events(events, validated_events_num):
        from assemblyline_v4_service.common.dynamic_service_helper import Events
        if validated_events_num:
            assert len(Events._validate_events(events)) == validated_events_num
        else:
            with pytest.raises(ValueError):
                Events._validate_events(events)

    @staticmethod
    @pytest.mark.parametrize("events, validated_events_num",
        [
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}], 1),
            ([{"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}], 0),
        ]
    )
    def test_get_process_events(events, validated_events_num):
        from assemblyline_v4_service.common.dynamic_service_helper import Events
        validated_events = Events._validate_events(events)
        assert len(Events._get_process_events(validated_events)) == validated_events_num

    @staticmethod
    @pytest.mark.parametrize("events, validated_events_num",
        [
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}], 0),
            ([{"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}], 1),
        ]
    )
    def test_get_network_events(events, validated_events_num):
        from assemblyline_v4_service.common.dynamic_service_helper import Events
        validated_events = Events._validate_events(events)
        assert len(Events._get_network_events(validated_events)) == validated_events_num

    @staticmethod
    @pytest.mark.parametrize("things_to_sort_by_timestamp, expected_result",
        [
            (None, []),
            ([], []),
            (
                    [{"timestamp": 1}],
                    [{"timestamp": 1}]
            ),
            (
                    [{"timestamp": 1}, {"timestamp": 2}],
                    [{"timestamp": 1}, {"timestamp": 2}]
            ),
            (
                    [{"timestamp": 1}, {"timestamp": 1}],
                    [{"timestamp": 1}, {"timestamp": 1}]
            ),
            (
                    [{"timestamp": 2}, {"timestamp": 1}],
                    [{"timestamp": 1}, {"timestamp": 2}]
            ),
            (
                    [{"timestamp": 3}, {"timestamp": 2}, {"timestamp": 1}],
                    [{"timestamp": 1}, {"timestamp": 2}, {"timestamp": 3}]
            ),
        ]
    )
    def test_sort_things_by_timestamp(things_to_sort_by_timestamp, expected_result, dummy_event_class):
        from assemblyline_v4_service.common.dynamic_service_helper import Events
        dummy_things = []
        dummy_results = []
        if things_to_sort_by_timestamp is None:
            assert Events._sort_things_by_timestamp(dummy_things) == []
            return
        for thing in things_to_sort_by_timestamp:
            dummy_things.append(dummy_event_class(thing))
        for result in expected_result:
            dummy_results.append(dummy_event_class(result))
        actual_result = Events._sort_things_by_timestamp(dummy_things)
        for index, item in enumerate(actual_result):
            assert item.__dict__ == dummy_results[index].__dict__

    @staticmethod
    @pytest.mark.parametrize("events, expected_events_dict",
        [
            ([{"pid": 1, "image": "blah", "timestamp": 1, "guid": None}], {1: {'guid': None, 'image': 'blah', 'pid': 1, 'timestamp': 1}}),
            ([{"pid": 1, "image": "blah", "timestamp": 1, "guid": None}, {"pid": 2, "image": "blah", "timestamp": 1, "guid": None}], {1: {'guid': None, 'image': 'blah', 'pid': 1, 'timestamp': 1}, 2: {'guid': None, 'image': 'blah', 'pid': 2, 'timestamp': 1}}),
            ([{"pid": 1, "image": "blah", "timestamp": 1, "guid": "a"}, {"pid": 2, "image": "blah", "timestamp": 1, "guid": "b"}], {"a": {'guid': "a", 'image': 'blah', 'pid': 1, 'timestamp': 1}, "b": {'guid': "b", 'image': 'blah', 'pid': 2, 'timestamp': 1}}),
        ]
    )
    def test_convert_events_to_dict(events, expected_events_dict):
        from assemblyline_v4_service.common.dynamic_service_helper import Event, Events
        event_objects = [Event(pid=event["pid"], image=event["image"], timestamp=event["timestamp"], guid=event["guid"]) for event in events]
        assert Events._convert_events_to_dict(event_objects) == expected_events_dict


class TestSandboxOntology:
    @staticmethod
    @pytest.mark.parametrize("events, expected_events", [([], [])])
    def test_init(events, expected_events):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        so = SandboxOntology(events=events)
        assert so.events == expected_events

    @staticmethod
    @pytest.mark.parametrize("processes_dict, expected_result",
        [
            # No processes
            ({}, []),
            # One process
            (
                    {1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1}},
                    [{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 1, "process_name": "blah", "children": []}]
            ),
            # One parent process and one child process
            (
                    {
                        1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1},
                        2: {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 1, "process_name": "blah",
                         "children":
                             [{"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 2, "process_name": "blah", "children": []},]
                        },
                    ],
            ),
            # Two unrelated processes
            (
                    {
                        1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1},
                        2: {"pid": 2, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 1},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 1, "process_name": "blah", "children": []},
                        {"pid": 2, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 2, "process_name": "blah", "children": []},
                    ],
            ),
            # Three processes consisting of a parent-child relationship and a rando process
            (
                    {
                        1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1},
                        2: {"pid": 2, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 1},
                        3: {"pid": 3, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 1},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 1, "process_name": "blah", "children": []},
                        {"pid": 2, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 2, "process_name": "blah",
                         "children":
                             [{"pid": 3, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 3, "process_name": "blah", "children": []}]
                         },
                    ],
            ),
            # Three processes consisting of a grandparent-parent-child relationship and one rando process
            (
                    {
                        1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1},
                        2: {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2},
                        3: {"pid": 3, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 3},
                        4: {"pid": 4, "ppid": 4, "image": "blah", "command_line": "blah", "timestamp": 2},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 1, "process_name": "blah",
                         "children":
                            [{"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2, "process_pid": 2, "process_name": "blah",
                              "children":
                                  [{"pid": 3, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 3, "process_pid": 3, "process_name": "blah",
                                    "children": []}, ]}]
                         },
                        {"pid": 4, "ppid": 4, "image": "blah", "command_line": "blah", "timestamp": 2, "process_pid": 4, "process_name": "blah", "children": []}
                    ],
            ),
            # Four processes consisting of a grandparent-parent-parent-child relationship
            (
                    {
                        1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1},
                        2: {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2},
                        3: {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3},
                        4: {"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 1, "process_name": "blah",
                         "children":
                             [
                                 {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2, "process_pid": 2, "process_name": "blah",
                                  "children":
                                      [{"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4,  "process_pid": 4, "process_name": "blah", "children": []}]},
                                 {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3,  "process_pid": 3, "process_name": "blah", "children": []}
                              ]
                         },
                    ],
            ),
            # Four processes consisting of a grandparent-parent-parent-child relationship with non-ordered times
            (
                    {
                        1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1},
                        2: {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3},
                        3: {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2},
                        4: {"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "process_pid": 1, "process_name": "blah",
                         "children":
                             [
                                 {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2, "process_pid": 3, "process_name": "blah",
                                  "children": []},
                                 {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3, "process_pid": 2, "process_name": "blah",
                                  "children":
                                      [{"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4, "process_pid": 4, "process_name": "blah",
                                        "children": []}]},
                             ]
                         },
                    ],
            ),
            # Four processes consisting of a grandparent-parent-parent-child relationship with non-ordered times using guids
            (
                    {
                        "a": {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "a", "pguid": None},
                        "b": {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3, "guid": "b", "pguid": "a"},
                        "c": {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2, "guid": "c", "pguid": "a"},
                        "d": {"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4, "guid": "d", "pguid": "b"},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "a", "pguid": None, "process_pid": 1, "process_name": "blah",
                         "children":
                             [
                                 {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2, "guid": "c", "pguid": "a", "process_pid": 3, "process_name": "blah",
                                  "children": []},
                                 {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3, "guid": "b", "pguid": "a", "process_pid": 2, "process_name": "blah",
                                  "children":
                                      [{"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4, "guid": "d", "pguid": "b", "process_pid": 4, "process_name": "blah",
                                        "children": []}]},
                             ]
                         },
                    ],
            ),
            # Four processes consisting of a grandparent-parent-parent-child relationship with non-ordered times using guids
            (
                    {
                        1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": None,
                              "pguid": None},
                        2: {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3, "guid": None,
                              "pguid": None},
                        3: {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2, "guid": None,
                              "pguid": None},
                        4: {"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4, "guid": None,
                              "pguid": None},
                    },
                    [
                        {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": None,
                         "pguid": None, "process_pid": 1, "process_name": "blah",
                         "children":
                             [
                                 {"pid": 3, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2,
                                  "guid": None, "pguid": None, "process_pid": 3, "process_name": "blah",
                                  "children": []},
                                 {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 3,
                                  "guid": None, "pguid": None, "process_pid": 2, "process_name": "blah",
                                  "children":
                                      [{"pid": 4, "ppid": 2, "image": "blah", "command_line": "blah", "timestamp": 4,
                                        "guid": None, "pguid": None, "process_pid": 4, "process_name": "blah",
                                        "children": []}]},
                             ]
                         },
                    ],
            ),
        ]
    )
    def test_convert_processes_dict_to_tree(processes_dict, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        actual_result = SandboxOntology._convert_processes_dict_to_tree(processes_dict)
        assert expected_result == actual_result

    @staticmethod
    @pytest.mark.parametrize("artifact_list",
        [
            None,
            [],
            [{"name": "blah", "path": "blah", "description": "blah", "to_be_extracted": True}],
        ]
    )
    def test_validate_artifacts(artifact_list):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology, Artifact
        actual_validated_artifact_list = SandboxOntology._validate_artifacts(artifact_list)
        if artifact_list is None:
            artifact_list = []
        for index, artifact in enumerate(artifact_list):
            expected_artifact = Artifact(
                name=artifact["name"],
                path=artifact["path"],
                description=artifact["description"],
                to_be_extracted=artifact["to_be_extracted"]
            )
            assert check_artifact_equality(expected_artifact, actual_validated_artifact_list[index])

    @staticmethod
    @pytest.mark.parametrize("artifact, expected_result_section_title",
        [
            (None, None),
            ({"path": "blah", "name": "blah", "description": "blah", "to_be_extracted": True}, None),
            ({"path": "blah", "name": "123_hollowshunter/hh_process_123_blah.exe", "description": "blah", "to_be_extracted": True}, "HollowsHunter Injected Portable Executable"),
            ({"path": "blah", "name": "123_hollowshunter/hh_process_123_blah.shc", "description": "blah", "to_be_extracted": True}, None),
            ({"path": "blah", "name": "123_hollowshunter/hh_process_123_blah.dll", "description": "blah", "to_be_extracted": True}, "HollowsHunter DLL"),
        ]
    )
    def test_handle_artifact(artifact, expected_result_section_title):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology, Artifact
        from assemblyline_v4_service.common.result import ResultSection, Heuristic

        if artifact is None:
            with pytest.raises(Exception):
                SandboxOntology._handle_artifact(artifact, None)
            return

        expected_result_section = None
        if expected_result_section_title is not None:
            expected_result_section = ResultSection(expected_result_section_title)
            expected_result_section.add_tag("dynamic.process.file_name", artifact["path"])
            if expected_result_section_title == "HollowsHunter Injected Portable Executable":
                heur = Heuristic(17)
                heur.add_signature_id("hollowshunter_pe")
                expected_result_section.heuristic = heur
        parent_result_section = ResultSection("blah")
        a = Artifact(
            name=artifact["name"],
            path=artifact["path"],
            description=artifact["description"],
            to_be_extracted=artifact["to_be_extracted"]
        )
        SandboxOntology._handle_artifact(a, parent_result_section)
        if len(parent_result_section.subsections) > 0:
            actual_result_section = parent_result_section.subsections[0]
        else:
            actual_result_section = None

        if expected_result_section is None and actual_result_section is None:
            assert True
        else:
            assert check_section_equality(actual_result_section, expected_result_section)

    @staticmethod
    @pytest.mark.parametrize("process_list, signatures, expected_result",
        [
            (None, [], {}),
            ([], [], {}),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": None, "pguid": None}], [{"pid": 1, "name": "blah", "score": 1}], {1: {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": None, "pguid": None, "signatures": {"blah": 1}}}),
            ([{"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": None, "pguid": None}], [{"pid": 1, "name": "blah", "score": 1}], {2: {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": None, "pguid": None, "signatures": {}}}),
            ([{"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "a", "pguid": None}], [{"pid": 1, "name": "blah", "score": 1}], {"a": {"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "a", "pguid": None, "signatures": {}}}),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "a", "pguid": None}], [{"pid": 1, "name": "blah", "score": 1}], {"a": {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "a", "pguid": None, "signatures": {"blah": 1}}}),
        ]
    )
    def test_match_signatures_to_process_events(process_list, signatures, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        o = SandboxOntology(process_list)
        actual_result = o._match_signatures_to_process_events(signature_dicts=signatures)
        assert actual_result == expected_result

    @staticmethod
    @pytest.mark.parametrize("process_list, safelist, expected_result", 
        [
            (None, [], []), 
            ([], [], []),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "blah", "pguid": "blahblah"}], [], [{'pid': 1, 'image': 'blah', 'timestamp': 1, 'guid': 'blah', 'ppid': 1, 'pguid': 'blahblah', 'command_line': 'blah', 'process_pid': 1, 'process_name': 'blah', 'children': []}]),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "blah", "pguid": "blahblah"}, {"pid": 2, "ppid": 1, "image": "blah2", "command_line": "blah2", "timestamp": 2, "guid": "blah2", "pguid": "blah"}], [], [{'pid': 1, 'image': 'blah', 'timestamp': 1, 'guid': 'blah', 'ppid': 1, 'pguid': 'blahblah', 'command_line': 'blah', 'process_pid': 1, 'process_name': 'blah', 'children': [{'pid': 2, 'image': 'blah2', 'timestamp': 2, 'guid': 'blah2', 'ppid': 1, 'pguid': 'blah', 'command_line': 'blah2', 'process_pid': 2, 'process_name': 'blah2', 'children': []}]}]),
            ( [ {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "blah", "pguid": "blahblah"}, {"pid": 2, "ppid": 1, "image": "blah2", "command_line": "blah2", "timestamp": 2, "guid": "blah2", "pguid": "blah"}, {"pid": 3, "ppid": 3, "image": "blah3", "command_line": "blah3", "timestamp": 1, "guid": "blah3", "pguid": "blah3"}, {"pid": 4, "ppid": 3, "image": "blah4", "command_line": "blah4", "timestamp": 2, "guid": "blah4", "pguid": "blah3"} ], [], [ {'pid': 1, 'image': 'blah', 'timestamp': 1, 'guid': 'blah', 'ppid': 1, 'pguid': 'blahblah', 'command_line': 'blah', 'process_pid': 1, 'process_name': 'blah', 'children': [ {'pid': 2, 'image': 'blah2', 'timestamp': 2, 'guid': 'blah2', 'ppid': 1, 'pguid': 'blah', 'command_line': 'blah2', 'process_pid': 2, 'process_name': 'blah2', 'children': [] } ] }, {'pid': 3, 'image': 'blah3', 'timestamp': 1, 'guid': 'blah3', 'ppid': 3, 'pguid': 'blah3', 'command_line': 'blah3', 'process_pid': 3, 'process_name': 'blah3', 'children': [ {'pid': 4, 'image': 'blah4', 'timestamp': 2, 'guid': 'blah4', 'ppid': 3, 'pguid': 'blah3', 'command_line': 'blah4', 'process_pid': 4, 'process_name': 'blah4', 'children': [] } ] } ] ),
            ( [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "excel", "pguid": "excel", "ppid": 0, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", }, { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "wmic1", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "wmic11", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "wmic111", "pguid": "wmic11", "ppid": 11, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "wmic12", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "wmic2", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "wmic3", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "wmic31", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "wmic32", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "wmic33", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", } ], [], [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "excel", "ppid": 0, "pguid": "excel", "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "process_pid": 0, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "wmic1", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 1, "process_name": "?sys32\\wbem\\wmic1.exe", "children": [ { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "wmic11", "ppid": 1, "pguid": "wmic1", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 11, "process_name": "?sys32\\wbem\\wmic11.exe", "children": [ { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "wmic111", "ppid": 11, "pguid": "wmic11", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 111, "process_name": "?sys32\\wbem\\wmic111.exe", "children": []}]}, { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "wmic12", "ppid": 1, "pguid": "wmic1", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 12, "process_name": "?sys32\\wbem\\wmic12.exe", "children": []}]}, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "wmic2", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 2, "process_name": "?sys32\\wbem\\wmic2.exe", "children": []}, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "wmic3", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 3, "process_name": "?sys32\\wbem\\wmic3.exe", "children": [ { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "wmic31", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 31, "process_name": "?sys32\\wbem\\wmic31.exe", "children": []}, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "wmic32", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 32, "process_name": "?sys32\\wbem\\wmic32.exe", "children": []}, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "wmic33", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 33, "process_name": "?sys32\\wbem\\wmic33.exe", "children": [] } ] } ] } ] ),
            ( [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "excel", "pguid": "excel", "ppid": 0, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", }, { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "wmic1", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "wmic11", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "wmic111", "pguid": "wmic11", "ppid": 11, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "wmic12", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "wmic2", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "wmic3", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "wmic31", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "wmic32", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "wmic33", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", } ], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac'], [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "excel", "ppid": 0, "pguid": "excel", "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "process_pid": 0, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "wmic1", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 1, "process_name": "?sys32\\wbem\\wmic1.exe", "children": [ { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "timestamp": 1631203148.413, "guid": "wmic12", "ppid": 1, "pguid": "wmic1", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 12, "process_name": "?sys32\\wbem\\wmic12.exe", "children": [] } ] }, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "timestamp": 1632203128.413, "guid": "wmic2", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 2, "process_name": "?sys32\\wbem\\wmic2.exe", "children": []}, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "timestamp": 1633203128.413, "guid": "wmic3", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 3, "process_name": "?sys32\\wbem\\wmic3.exe", "children": [ { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "timestamp": 1634203128.413, "guid": "wmic31", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 31, "process_name": "?sys32\\wbem\\wmic31.exe", "children": []}, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "timestamp": 1635203128.413, "guid": "wmic32", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 32, "process_name": "?sys32\\wbem\\wmic32.exe", "children": []}, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "timestamp": 1636203128.413, "guid": "wmic33", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 33, "process_name": "?sys32\\wbem\\wmic33.exe", "children": [] } ] } ] } ] ),
            ( [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "excel", "pguid": "excel", "ppid": 0, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", }, { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "wmic1", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "wmic11", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "wmic111", "pguid": "wmic11", "ppid": 11, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "wmic12", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "wmic2", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "wmic3", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "wmic31", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "wmic32", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "wmic33", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", } ], ['6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "excel", "ppid": 0, "pguid": "excel", "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "process_pid": 0, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "wmic1", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 1, "process_name": "?sys32\\wbem\\wmic1.exe", "children": [ { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "timestamp": 1631203138.413, "guid": "wmic11", "ppid": 1, "pguid": "wmic1", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 11, "process_name": "?sys32\\wbem\\wmic11.exe", "children": [ { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "timestamp": 1631303128.413, "guid": "wmic111", "ppid": 11, "pguid": "wmic11", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 111, "process_name": "?sys32\\wbem\\wmic111.exe", "children": []}]}, { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "timestamp": 1631203148.413, "guid": "wmic12", "ppid": 1, "pguid": "wmic1", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 12, "process_name": "?sys32\\wbem\\wmic12.exe", "children": []}]}, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "timestamp": 1632203128.413, "guid": "wmic2", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 2, "process_name": "?sys32\\wbem\\wmic2.exe", "children": []}, ] } ] ),
            ( [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "excel", "pguid": "excel", "ppid": 0, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", }, { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "wmic1", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "wmic11", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "wmic111", "pguid": "wmic11", "ppid": 11, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "wmic12", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "wmic2", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "wmic3", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "wmic31", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "wmic32", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "wmic33", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", } ], ['6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b'], [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "excel", "ppid": 0, "pguid": "excel", "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "process_pid": 0, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "wmic1", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 1, "process_name": "?sys32\\wbem\\wmic1.exe", "children": [ { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "timestamp": 1631203138.413, "guid": "wmic11", "ppid": 1, "pguid": "wmic1", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 11, "process_name": "?sys32\\wbem\\wmic11.exe", "children": [ { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "timestamp": 1631303128.413, "guid": "wmic111", "ppid": 11, "pguid": "wmic11", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 111, "process_name": "?sys32\\wbem\\wmic111.exe", "children": []}]}, ] }, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "timestamp": 1633203128.413, "guid": "wmic3", "ppid": 0, "pguid": "excel", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 3, "process_name": "?sys32\\wbem\\wmic3.exe", "children": [ { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "timestamp": 1634203128.413, "guid": "wmic31", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 31, "process_name": "?sys32\\wbem\\wmic31.exe", "children": []}, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "timestamp": 1635203128.413, "guid": "wmic32", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 32, "process_name": "?sys32\\wbem\\wmic32.exe", "children": []}, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "timestamp": 1636203128.413, "guid": "wmic33", "ppid": 3, "pguid": "wmic3", "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "process_pid": 33, "process_name": "?sys32\\wbem\\wmic33.exe", "children": [] } ] } ] } ] ),
            ( [ { "pid": 0, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "excel", "pguid": "excel", "ppid": 0, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", }, { "pid": 1, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "wmic1", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 11, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "wmic11", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 111, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "wmic111", "pguid": "wmic11", "ppid": 11, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 12, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "wmic12", "pguid": "wmic1", "ppid": 1, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 2, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "wmic2", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 3, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "wmic3", "pguid": "excel", "ppid": 0, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 31, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "wmic31", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 32, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "wmic32", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", }, { "pid": 33, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "wmic33", "pguid": "wmic3", "ppid": 3, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", } ], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], [ ] )
        ]
    )
    def test_get_process_tree(process_list, safelist, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        o = SandboxOntology(process_list)
        actual_result = o.get_process_tree(safelist)
        assert actual_result == expected_result

    @staticmethod
    @pytest.mark.parametrize("process_list, signatures, expected_result",
        [
            (None, [], []),
            ([], [], []),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "blah", "pguid": "blahblah"}], [{"pid": 1, "name": "blah", "score": 1}], [{"children": [], "pid": 1, "ppid": 1, "process_name": "blah", "process_pid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "blah", "pguid": "blahblah", "signatures": {"blah": 1}}]),
            ([{"pid": 2, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "blah", "pguid": "blahblah"}], [{"pid": 1, "name": "blah", "score": 1}], [{"children": [], "pid": 2, "ppid": 1, "process_name": "blah", "process_pid": 2, "image": "blah", "command_line": "blah", "timestamp": 1, "guid": "blah", "pguid": "blahblah", "signatures": {}}]),
        ]
    )
    def test_get_process_tree_with_signatures(process_list, signatures, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        o = SandboxOntology(process_list)
        actual_result = o.get_process_tree_with_signatures(signatures=signatures)
        assert actual_result == expected_result

    @staticmethod
    @pytest.mark.parametrize(
        "parent, node, expected_node, expected_hashes",
        [
            ("", {"blah": "blah", "image": "got the image", "blahblah": "blahblah",
                  "children": [{"image": "image number 2", "children": []},
                               {"image": "image number 3", "blah": "blah", "children": []}]},
                {"blah": "blah", "image": "got the image", "blahblah": "blahblah", "node_hash": "b71bf6eacf36ecdf07b3f1efa5d6f50725271ca85369b966e19da5b76c175b5b",
                  "children": [{"image": "image number 2", "node_hash": "294156e02fb77c860933c93da8629dbceab367629a1ff9af68ff4b03c8596b17", "children": []},
                               {"image": "image number 3", "blah": "blah", "node_hash": "0483e740e929697527964c71227dd76403cdc91ca16e7a4a9a430f734481f129", "children": []}]},
             ['b71bf6eacf36ecdf07b3f1efa5d6f50725271ca85369b966e19da5b76c175b5b',
              '294156e02fb77c860933c93da8629dbceab367629a1ff9af68ff4b03c8596b17',
              '0483e740e929697527964c71227dd76403cdc91ca16e7a4a9a430f734481f129'])
        ]
    )
    def test_create_hashed_node(parent, node, expected_node, expected_hashes):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        hashes = []
        SandboxOntology._create_hashed_node(parent, node, hashes, 'root')

        for x in range(len(hashes)):
            assert hashes[x] == expected_hashes[x]
        
        assert node == expected_node

    @staticmethod
    @pytest.mark.parametrize(
        "process_tree, expected_process_tree, expected_process_tree_hashes",
        [
            ([{"pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": {"injection_resumethread": 250}, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}]}, {"pid": 6400, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}]}, {"pid": 6400, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}, {"pid": 6400, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}, {"pid": 6400, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}, {"pid": 6400, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}]}]}], [{ "pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": { "injection_resumethread": 250 }, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "timestamp": 1631203138.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "timestamp": 1631303128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "timestamp": 1631203148.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "timestamp": 1633203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "timestamp": 1634203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "timestamp": 1635203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "timestamp": 1636203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] } ] }], ['d49859686805ced2d011ca79451353349e7fc07a3b15bf220eaff13cdece310a']),
            ([{"pid": 7100, "image": "C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE", "timestamp": 1631903280.208475, "guid": "placeholder", "ppid": 2528, "command_line": "\"C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE\" C:\\Users\\buddy\\AppData\\Local\\Temp\\3617524f469002f54459d47e97fe757661b4e7a776b04cbfab50e746d779a31c.xls", "signatures": {"stealth_window": 100, "injection_resumethread": 250}, "process_pid": 7100, "process_name": "C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE", "children": [ {"pid": 5036, "image": "C:\\Windows\\SysWOW64\\cmd.exe", "timestamp": 1631903284.061, "guid": "{4e46ad60-de34-6144-d803-000000000c00}", "ppid": 7100, "command_line": "\"C:\\Windows\\System32\\cmd.exe\" /C PO^W^ers^HE^lL -E somebase64=", "signatures": {"injection_resumethread": 250}, "process_pid": 5036, "process_name": "C:\\Windows\\SysWOW64\\cmd.exe", "children": [ {"pid": 4796, "image": "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe", "timestamp": 1631903284.377, "guid": "{4e46ad60-de34-6144-dc03-000000000c00}", "ppid": 5036, "command_line": "POWersHElL  -E somebase64=", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "privilege_luid_check": 100, "injection_resumethread": 250}, "process_pid": 4796, "process_name": "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe", "children": [ {"pid": 4832, "image": "C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe", "timestamp": 1631903312.724, "guid": "{4e46ad60-de50-6144-e103-000000000c00}", "ppid": 4796, "command_line": "\"C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe\"", "signatures": {}, "process_pid": 4832, "process_name": "C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe", "children": []}]}]}]}, {"pid": 1356, "image": "C:\\Windows\\System32\\svchost.exe", "timestamp": 1631903307.569, "guid": "{4e46ad60-de4b-6144-e003-000000000c00}", "ppid": 764, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p -s BITS", "signatures": {}, "process_pid": 1356, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": []}], [ {"pid": 7100, "image": "C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE", "node_hash": "1d538431efa590026387201e16284f9b4c32b1d3448e306360f5e612f0acc221", "timestamp": 1631903280.208475, "guid": "placeholder", "ppid": 2528, "command_line": "\"C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE\" C:\\Users\\buddy\\AppData\\Local\\Temp\\3617524f469002f54459d47e97fe757661b4e7a776b04cbfab50e746d779a31c.xls", "signatures": {"stealth_window": 100, "injection_resumethread": 250}, "process_pid": 7100, "process_name": "C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE", "children": [ {"pid": 5036, "image": "C:\\Windows\\SysWOW64\\cmd.exe", "node_hash": "fe49aab613d1543277a1153e74179f7f48bf4939d1553089a40160f458fd74b2", "timestamp": 1631903284.061, "guid": "{4e46ad60-de34-6144-d803-000000000c00}", "ppid": 7100, "command_line": "\"C:\\Windows\\System32\\cmd.exe\" /C PO^W^ers^HE^lL -E somebase64=", "signatures": {"injection_resumethread": 250}, "process_pid": 5036, "process_name": "C:\\Windows\\SysWOW64\\cmd.exe", "children": [ {"pid": 4796, "image": "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe", "node_hash": "354cb6baf4ef8f534f1b97ce2306b660a873a213d19ea1b5ae4e784baf5f3e92", "timestamp": 1631903284.377, "guid": "{4e46ad60-de34-6144-dc03-000000000c00}", "ppid": 5036, "command_line": "POWersHElL  -E somebase64=", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "privilege_luid_check": 100, "injection_resumethread": 250}, "process_pid": 4796, "process_name": "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe", "children": [ {"pid": 4832, "image": "C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe", "node_hash": "7e7b9840296dd1b624095faa63388eddf31cea89180fe7d6e4eb01fd52ab14b9", "timestamp": 1631903312.724, "guid": "{4e46ad60-de50-6144-e103-000000000c00}", "ppid": 4796, "command_line": "\"C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe\"", "signatures": {}, "process_pid": 4832, "process_name": "C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe", "children": []}] }] }] }, {"pid": 1356, "image": "C:\\Windows\\System32\\svchost.exe", "node_hash": "61ed4f85c992073bf9cf86a8ccf97a3836235b3026eee472b11bdd9eb577ed2a", "timestamp": 1631903307.569, "guid": "{4e46ad60-de4b-6144-e003-000000000c00}", "ppid": 764, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p -s BITS", "signatures": {}, "process_pid": 1356, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": []}], ['7b01e74a2df59fcb268710af343402611a7d262f2ecee3bf2dfb700b566019d2', '13d002167decebba0b409eadd14efcc27248c12b0ec9d52012506c9417efd9a8']),
            ([{"pid": 2004, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "timestamp": 1631805773.5581, "guid": "placeholder", "ppid": 588, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CBTkyZTyJqQBKjiXnVZPe", "signatures": {}, "process_pid": 2004, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [{"pid": 1176, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631805773.662, "guid": "{4e46ad60-614d-6143-cd00-000000000c00}", "ppid": 2004, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CBTkyZTyJqQBKjiXnVZPe", "signatures": {}, "process_pid": 1176, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 4168, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "timestamp": 1631805773.573721, "guid": "placeholder", "ppid": 2316, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CENYKOvlmzxBUnuXlXTXsMchOtlaIl", "signatures": {}, "process_pid": 4168, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [{"pid": 2252, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631805773.667, "guid": "{4e46ad60-614d-6143-cf00-000000000c00}", "ppid": 4168, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CENYKOvlmzxBUnuXlXTXsMchOtlaIl", "signatures": {}, "process_pid": 2252, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 672, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "timestamp": 1631805773.667471, "guid": "placeholder", "ppid": 824, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DchcnVYBDwxUKIQdcrjRnSnPxWHXvP", "signatures": {}, "process_pid": 672, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [{"pid": 3320, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631805773.761, "guid": "{4e46ad60-614d-6143-d600-000000000c00}", "ppid": 672, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DchcnVYBDwxUKIQdcrjRnSnPxWHXvP", "signatures": {}, "process_pid": 3320, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 1780, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "timestamp": 1631805773.776844, "guid": "placeholder", "ppid": 1660, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllRegisterServer", "signatures": {}, "process_pid": 1780, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [{"pid": 7872, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631805773.867, "guid": "{4e46ad60-614d-6143-db00-000000000c00}", "ppid": 1780, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllRegisterServer", "signatures": {}, "process_pid": 7872, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 3316, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "timestamp": 1631805773.933094, "guid": "placeholder", "ppid": 3232, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllUnregisterServer", "signatures": {}, "process_pid": 3316, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [{"pid": 5824, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631805774.012, "guid": "{4e46ad60-614e-6143-de00-000000000c00}", "ppid": 3316, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllUnregisterServer", "signatures": {}, "process_pid": 5824, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 8048, "image": "C:\\Windows\\System32\\slui.exe", "timestamp": 1631805793.051, "guid": "{4e46ad60-6161-6143-e100-000000000c00}", "ppid": 1012, "command_line": "C:\\WINDOWS\\System32\\slui.exe -Embedding", "signatures": {}, "process_pid": 8048, "process_name": "C:\\Windows\\System32\\slui.exe", "children": []}, {"pid": 6656, "image": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe", "timestamp": 1631805814.604, "guid": "{4e46ad60-6176-6143-e200-000000000c00}", "ppid": 1012, "command_line": "\"C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe\" -ServerName:Hx.IPC.Server", "signatures": {}, "process_pid": 6656, "process_name": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe", "children": []}, {"pid": 1580, "image": "C:\\Windows\\System32\\backgroundTaskHost.exe", "timestamp": 1631805814.606, "guid": "{4e46ad60-6176-6143-e300-000000000c00}", "ppid": 1012, "command_line": "\"C:\\WINDOWS\\system32\\backgroundTaskHost.exe\" -ServerName:App.AppXmtcan0h2tfbfy7k9kn8hbxb6dmzz1zh0.mca", "signatures": {}, "process_pid": 1580, "process_name": "C:\\Windows\\System32\\backgroundTaskHost.exe", "children": []}, {"pid": 780, "image": "C:\\Windows\\System32\\RuntimeBroker.exe", "timestamp": 1631805814.848, "guid": "{4e46ad60-6176-6143-e400-000000000c00}", "ppid": 1012, "command_line": "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding", "signatures": {}, "process_pid": 780, "process_name": "C:\\Windows\\System32\\RuntimeBroker.exe", "children": []}, {"pid": 2964, "image": "C:\\Windows\\System32\\svchost.exe", "timestamp": 1631805816.318, "guid": "{4e46ad60-6178-6143-e500-000000000c00}", "ppid": 808, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p -s BITS", "signatures": {}, "process_pid": 2964, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": []}, {"pid": 2768, "image": "C:\\Windows\\System32\\svchost.exe", "timestamp": 1631805848.674, "guid": "{4e46ad60-6198-6143-e900-000000000c00}", "ppid": 808, "command_line": "C:\\WINDOWS\\system32\\svchost.exe -k wusvcs -p -s WaaSMedicSvc", "signatures": {}, "process_pid": 2768, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": []}, {"pid": 1268, "image": "C:\\Windows\\System32\\svchost.exe", "timestamp": 1631805848.857, "guid": "{4e46ad60-6198-6143-eb00-000000000c00}", "ppid": 808, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p", "signatures": {}, "process_pid": 1268, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": []}], [ { "pid": 2004, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "node_hash": "f04ea725baf75ed43d0d7553f6c8140ac9da39e9a5cbd73925c8bceff702b19e", "timestamp": 1631805773.5581, "guid": "placeholder", "ppid": 588, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CBTkyZTyJqQBKjiXnVZPe", "signatures": {}, "process_pid": 2004, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [ { "pid": 1176, "image": "C:\\Windows\\System32\\rundll32.exe", "node_hash": "02678ebb98b5b6603cc968c929786bf90298a3a07632c4d0d42f809f5d02d58c", "timestamp": 1631805773.662, "guid": "{4e46ad60-614d-6143-cd00-000000000c00}", "ppid": 2004, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CBTkyZTyJqQBKjiXnVZPe", "signatures": {}, "process_pid": 1176, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": [] } ] }, { "pid": 4168, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "node_hash": "f04ea725baf75ed43d0d7553f6c8140ac9da39e9a5cbd73925c8bceff702b19e", "timestamp": 1631805773.573721, "guid": "placeholder", "ppid": 2316, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CENYKOvlmzxBUnuXlXTXsMchOtlaIl", "signatures": {}, "process_pid": 4168, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [ { "pid": 2252, "image": "C:\\Windows\\System32\\rundll32.exe", "node_hash": "02678ebb98b5b6603cc968c929786bf90298a3a07632c4d0d42f809f5d02d58c", "timestamp": 1631805773.667, "guid": "{4e46ad60-614d-6143-cf00-000000000c00}", "ppid": 4168, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,CENYKOvlmzxBUnuXlXTXsMchOtlaIl", "signatures": {}, "process_pid": 2252, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": [] } ] }, { "pid": 672, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "node_hash": "f04ea725baf75ed43d0d7553f6c8140ac9da39e9a5cbd73925c8bceff702b19e", "timestamp": 1631805773.667471, "guid": "placeholder", "ppid": 824, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DchcnVYBDwxUKIQdcrjRnSnPxWHXvP", "signatures": {}, "process_pid": 672, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [ { "pid": 3320, "image": "C:\\Windows\\System32\\rundll32.exe", "node_hash": "02678ebb98b5b6603cc968c929786bf90298a3a07632c4d0d42f809f5d02d58c", "timestamp": 1631805773.761, "guid": "{4e46ad60-614d-6143-d600-000000000c00}", "ppid": 672, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DchcnVYBDwxUKIQdcrjRnSnPxWHXvP", "signatures": {}, "process_pid": 3320, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": [] } ] }, { "pid": 1780, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "node_hash": "f04ea725baf75ed43d0d7553f6c8140ac9da39e9a5cbd73925c8bceff702b19e", "timestamp": 1631805773.776844, "guid": "placeholder", "ppid": 1660, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllRegisterServer", "signatures": {}, "process_pid": 1780, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [ { "pid": 7872, "image": "C:\\Windows\\System32\\rundll32.exe", "node_hash": "02678ebb98b5b6603cc968c929786bf90298a3a07632c4d0d42f809f5d02d58c", "timestamp": 1631805773.867, "guid": "{4e46ad60-614d-6143-db00-000000000c00}", "ppid": 1780, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllRegisterServer", "signatures": {}, "process_pid": 7872, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": [] } ] }, { "pid": 3316, "image": "C:\\Windows\\SysWOW64\\rundll32.exe", "node_hash": "f04ea725baf75ed43d0d7553f6c8140ac9da39e9a5cbd73925c8bceff702b19e", "timestamp": 1631805773.933094, "guid": "placeholder", "ppid": 3232, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllUnregisterServer", "signatures": {}, "process_pid": 3316, "process_name": "C:\\Windows\\SysWOW64\\rundll32.exe", "children": [ { "pid": 5824, "image": "C:\\Windows\\System32\\rundll32.exe", "node_hash": "02678ebb98b5b6603cc968c929786bf90298a3a07632c4d0d42f809f5d02d58c", "timestamp": 1631805774.012, "guid": "{4e46ad60-614e-6143-de00-000000000c00}", "ppid": 3316, "command_line": "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\tmpvwikd8nx.dll,DllUnregisterServer", "signatures": {}, "process_pid": 5824, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": [] } ] }, { "pid": 8048, "image": "C:\\Windows\\System32\\slui.exe", "node_hash": "d4ffea868c299d6a8042de67928fdbdb87962541a2f2027ce2894c4f9668cb7b", "timestamp": 1631805793.051, "guid": "{4e46ad60-6161-6143-e100-000000000c00}", "ppid": 1012, "command_line": "C:\\WINDOWS\\System32\\slui.exe -Embedding", "signatures": {}, "process_pid": 8048, "process_name": "C:\\Windows\\System32\\slui.exe", "children": [] }, { "pid": 6656, "image": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe", "node_hash": "eea01420e00bd1b9628ff606567c6bfba498f3c528588896b4c5b2df0a0adb2a", "timestamp": 1631805814.604, "guid": "{4e46ad60-6176-6143-e200-000000000c00}", "ppid": 1012, "command_line": "\"C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe\" -ServerName:Hx.IPC.Server", "signatures": {}, "process_pid": 6656, "process_name": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe", "children": [] }, { "pid": 1580, "image": "C:\\Windows\\System32\\backgroundTaskHost.exe", "node_hash": "290242d7b8fb826c24c48208819149c9c1651234601116b6eb80086c49291930", "timestamp": 1631805814.606, "guid": "{4e46ad60-6176-6143-e300-000000000c00}", "ppid": 1012, "command_line": "\"C:\\WINDOWS\\system32\\backgroundTaskHost.exe\" -ServerName:App.AppXmtcan0h2tfbfy7k9kn8hbxb6dmzz1zh0.mca", "signatures": {}, "process_pid": 1580, "process_name": "C:\\Windows\\System32\\backgroundTaskHost.exe", "children": [] }, { "pid": 780, "image": "C:\\Windows\\System32\\RuntimeBroker.exe", "node_hash": "6e06b06abb69086464746156b313bb85e792314ef5bb5f92faec74e6f48a66f1", "timestamp": 1631805814.848, "guid": "{4e46ad60-6176-6143-e400-000000000c00}", "ppid": 1012, "command_line": "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding", "signatures": {}, "process_pid": 780, "process_name": "C:\\Windows\\System32\\RuntimeBroker.exe", "children": [] }, { "pid": 2964, "image": "C:\\Windows\\System32\\svchost.exe", "node_hash": "61ed4f85c992073bf9cf86a8ccf97a3836235b3026eee472b11bdd9eb577ed2a", "timestamp": 1631805816.318, "guid": "{4e46ad60-6178-6143-e500-000000000c00}", "ppid": 808, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p -s BITS", "signatures": {}, "process_pid": 2964, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": [] }, { "pid": 2768, "image": "C:\\Windows\\System32\\svchost.exe", "node_hash": "61ed4f85c992073bf9cf86a8ccf97a3836235b3026eee472b11bdd9eb577ed2a", "timestamp": 1631805848.674, "guid": "{4e46ad60-6198-6143-e900-000000000c00}", "ppid": 808, "command_line": "C:\\WINDOWS\\system32\\svchost.exe -k wusvcs -p -s WaaSMedicSvc", "signatures": {}, "process_pid": 2768, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": [] }, { "pid": 1268, "image": "C:\\Windows\\System32\\svchost.exe", "node_hash": "61ed4f85c992073bf9cf86a8ccf97a3836235b3026eee472b11bdd9eb577ed2a", "timestamp": 1631805848.857, "guid": "{4e46ad60-6198-6143-eb00-000000000c00}", "ppid": 808, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p", "signatures": {}, "process_pid": 1268, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": [] } ], ['678c1a074bcdbc68d09301bcd83fa4592ba8582edb991285fc68029a2ed6a87b', '678c1a074bcdbc68d09301bcd83fa4592ba8582edb991285fc68029a2ed6a87b', '678c1a074bcdbc68d09301bcd83fa4592ba8582edb991285fc68029a2ed6a87b', '678c1a074bcdbc68d09301bcd83fa4592ba8582edb991285fc68029a2ed6a87b', '678c1a074bcdbc68d09301bcd83fa4592ba8582edb991285fc68029a2ed6a87b', 'c9a3688813818267a49f2d6a9430aea39d8f31b9d1197f0900e8a916fef33143', '91944a6f3ab216be112650200704d070eff8921edeec7dc9fe06a048aaa70e7d', 'd61610c9578de6b2ccc7062a56f06bdbee06f9a5533611367b4c1e1533e0d3c4', '643944c5cf7a9b9f956b6ac6f2a36c35750ee883a33ac514ef5d118e73ec8530', '13d002167decebba0b409eadd14efcc27248c12b0ec9d52012506c9417efd9a8', '13d002167decebba0b409eadd14efcc27248c12b0ec9d52012506c9417efd9a8', '13d002167decebba0b409eadd14efcc27248c12b0ec9d52012506c9417efd9a8']),
            ([{"pid": 4700, "image": "C:\\Windows\\SysWOW64\\mshta.exe", "timestamp": 1631560156.09572, "guid": "placeholder", "ppid": 5696, "command_line": "\"C:\\Windows\\System32\\mshta.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\d0fd7acc38b3105facd6995344242f28e45f5384c0fdf2ec93ea24bfbc1dc9e6.hta", "signatures": {"checks_debugger": 10}, "process_pid": 4700, "process_name": "C:\\Windows\\SysWOW64\\mshta.exe", "children": []}, {"pid": 7812, "image": "C:\\Program Files (x86)\\Internet Explorer\\ielowutil.exe", "timestamp": 1631560157.731, "guid": "{4e46ad60-a1dd-613f-c300-000000000c00}", "ppid": 984, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\ielowutil.exe\" -CLSID:{0002DF01-0000-0000-C000-000000000046} -Embedding", "signatures": {}, "process_pid": 7812, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\ielowutil.exe", "children": []}, {"pid": 7568, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631560157.769, "guid": "{4e46ad60-a1dd-613f-c400-000000000c00}", "ppid": 984, "command_line": "\"C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE\" -Embedding", "signatures": {}, "process_pid": 7568, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": [ {"pid": 6520, "image": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "timestamp": 1631560158.302, "guid": "{4e46ad60-a1de-613f-c500-000000000c00}", "ppid": 7568, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE\" SCODEF:7568 CREDAT:17410 /prefetch:2", "signatures": {}, "process_pid": 6520, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 6680, "image": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "timestamp": 1631560158.792, "guid": "{4e46ad60-a1de-613f-c600-000000000c00}", "ppid": 7568, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE\" SCODEF:7568 CREDAT:82946 /prefetch:2", "signatures": {}, "process_pid": 6680, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 5920, "image": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "timestamp": 1631560159.309, "guid": "{4e46ad60-a1df-613f-c700-000000000c00}", "ppid": 7568, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE\" SCODEF:7568 CREDAT:17420 /prefetch:2", "signatures": {}, "process_pid": 5920, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 6040, "image": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "timestamp": 1631560159.498, "guid": "{4e46ad60-a1df-613f-c800-000000000c00}", "ppid": 7568, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE\" SCODEF:7568 CREDAT:17422 /prefetch:2", "signatures": {}, "process_pid": 6040, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 8000, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560159.573, "guid": "{4e46ad60-a1df-613f-c900-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:123\",", "signatures": {}, "process_pid": 8000, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 7164, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560159.715, "guid": "{4e46ad60-a1df-613f-ca00-000000000c00}", "ppid": 8000, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:123\",", "signatures": {}, "process_pid": 7164, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 7456, "image": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "timestamp": 1631560160.127, "guid": "{4e46ad60-a1e0-613f-cc00-000000000c00}", "ppid": 7568, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE\" SCODEF:7568 CREDAT:82958 /prefetch:2", "signatures": {}, "process_pid": 7456, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4808, "image": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "timestamp": 1631560160.446, "guid": "{4e46ad60-a1e0-613f-d000-000000000c00}", "ppid": 7568, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE\" SCODEF:7568 CREDAT:17424 /prefetch:2", "signatures": {}, "process_pid": 4808, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 6220, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560160.899, "guid": "{4e46ad60-a1e0-613f-d100-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:123\",", "signatures": {}, "process_pid": 6220, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 8012, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560161.084, "guid": "{4e46ad60-a1e1-613f-d500-000000000c00}", "ppid": 6220, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:123\",", "signatures": {}, "process_pid": 8012, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 4768, "image": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "timestamp": 1631560160.981, "guid": "{4e46ad60-a1e0-613f-d300-000000000c00}", "ppid": 7568, "command_line": "\"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE\" SCODEF:7568 CREDAT:82972 /prefetch:2", "signatures": {}, "process_pid": 4768, "process_name": "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 5444, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560161.072, "guid": "{4e46ad60-a1e1-613f-d400-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:123\",", "signatures": {}, "process_pid": 5444, "process_name": "C:\\Windows\\System32\\control.exe", "children": []}, {"pid": 5952, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560161.633, "guid": "{4e46ad60-a1e1-613f-d800-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:123\",", "signatures": {}, "process_pid": 5952, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 7128, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560161.82, "guid": "{4e46ad60-a1e1-613f-db00-000000000c00}", "ppid": 5952, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:123\",", "signatures": {}, "process_pid": 7128, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 5492, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560161.959, "guid": "{4e46ad60-a1e1-613f-dd00-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../../AppData/Local/Temp/Low/championship.inf\",", "signatures": {}, "process_pid": 5492, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 8044, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560162.153, "guid": "{4e46ad60-a1e2-613f-e000-000000000c00}", "ppid": 5492, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../../AppData/Local/Temp/Low/championship.inf\",", "signatures": {}, "process_pid": 8044, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 5460, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560162.141, "guid": "{4e46ad60-a1e2-613f-df00-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../../AppData/Local/Temp/championship.inf\",", "signatures": {}, "process_pid": 5460, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 6508, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560162.375, "guid": "{4e46ad60-a1e2-613f-e200-000000000c00}", "ppid": 5460, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../../AppData/Local/Temp/championship.inf\",", "signatures": {}, "process_pid": 6508, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 8020, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560162.284, "guid": "{4e46ad60-a1e2-613f-e100-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../../../AppData/Local/Temp/Low/championship.inf\",", "signatures": {}, "process_pid": 8020, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 7740, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560162.413, "guid": "{4e46ad60-a1e2-613f-e300-000000000c00}", "ppid": 8020, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../../../AppData/Local/Temp/Low/championship.inf\",", "signatures": {}, "process_pid": 7740, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 5624, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560162.446, "guid": "{4e46ad60-a1e2-613f-e400-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../../../AppData/Local/Temp/championship.inf\",", "signatures": {}, "process_pid": 5624, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 4956, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560162.576, "guid": "{4e46ad60-a1e2-613f-e500-000000000c00}", "ppid": 5624, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../../../AppData/Local/Temp/championship.inf\",", "signatures": {}, "process_pid": 4956, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 7104, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560162.593, "guid": "{4e46ad60-a1e2-613f-e600-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../../../../Temp/Low/championship.inf\",", "signatures": {}, "process_pid": 7104, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 7360, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560162.772, "guid": "{4e46ad60-a1e2-613f-e800-000000000c00}", "ppid": 7104, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../../../../Temp/Low/championship.inf\",", "signatures": {}, "process_pid": 7360, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 6052, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560162.714, "guid": "{4e46ad60-a1e2-613f-e700-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../../../../Temp/championship.inf\",", "signatures": {}, "process_pid": 6052, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 7308, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560162.852, "guid": "{4e46ad60-a1e2-613f-e900-000000000c00}", "ppid": 6052, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../../../../Temp/championship.inf\",", "signatures": {}, "process_pid": 7308, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 6952, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560162.929, "guid": "{4e46ad60-a1e2-613f-ea00-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../Low/championship.inf\",", "signatures": {}, "process_pid": 6952, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 7552, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560163.148, "guid": "{4e46ad60-a1e3-613f-ec00-000000000c00}", "ppid": 6952, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../Low/championship.inf\",", "signatures": {}, "process_pid": 7552, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}, {"pid": 7148, "image": "C:\\Windows\\System32\\control.exe", "timestamp": 1631560163.052, "guid": "{4e46ad60-a1e3-613f-eb00-000000000c00}", "ppid": 7568, "command_line": "\"C:\\WINDOWS\\System32\\control.exe\" \".cpl:../../championship.inf\",", "signatures": {}, "process_pid": 7148, "process_name": "C:\\Windows\\System32\\control.exe", "children": [ {"pid": 5448, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560163.178, "guid": "{4e46ad60-a1e3-613f-ed00-000000000c00}", "ppid": 7148, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:../../championship.inf\",", "signatures": {}, "process_pid": 5448, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}]}]}, {"pid": 4388, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560160.382, "guid": "{4e46ad60-a1e0-613f-cf00-000000000c00}", "ppid": 5444, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:123\",", "signatures": {}, "process_pid": 4388, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}, {"pid": 7100, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560161.836, "guid": "{4e46ad60-a1e1-613f-dc00-000000000c00}", "ppid": 7360, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:123\",", "signatures": {}, "process_pid": 7100, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}, {"pid": 4648, "image": "C:\\Windows\\System32\\rundll32.exe", "timestamp": 1631560162.074, "guid": "{4e46ad60-a1e2-613f-de00-000000000c00}", "ppid": 5448, "command_line": "\"C:\\WINDOWS\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \".cpl:123\",", "signatures": {}, "process_pid": 4648, "process_name": "C:\\Windows\\System32\\rundll32.exe", "children": []}, {"pid": 1060, "image": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe", "timestamp": 1631560207.708, "guid": "{4e46ad60-a20f-613f-ef00-000000000c00}", "ppid": 984, "command_line": "\"C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe\" -ServerName:Hx.IPC.Server", "signatures": {}, "process_pid": 1060, "process_name": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe", "children": []}, {"pid": 1396, "image": "C:\\Windows\\System32\\backgroundTaskHost.exe", "timestamp": 1631560207.711, "guid": "{4e46ad60-a20f-613f-f000-000000000c00}", "ppid": 984, "command_line": "\"C:\\WINDOWS\\system32\\backgroundTaskHost.exe\" -ServerName:App.AppXmtcan0h2tfbfy7k9kn8hbxb6dmzz1zh0.mca", "signatures": {}, "process_pid": 1396, "process_name": "C:\\Windows\\System32\\backgroundTaskHost.exe", "children": []}, {"pid": 2908, "image": "C:\\Windows\\System32\\RuntimeBroker.exe", "timestamp": 1631560207.928, "guid": "{4e46ad60-a20f-613f-f100-000000000c00}", "ppid": 984, "command_line": "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding", "signatures": {}, "process_pid": 2908, "process_name": "C:\\Windows\\System32\\RuntimeBroker.exe", "children": []}, {"pid": 4340, "image": "C:\\Windows\\System32\\svchost.exe", "timestamp": 1631560219.817, "guid": "{4e46ad60-a21b-613f-f200-000000000c00}", "ppid": 780, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p -s BITS", "signatures": {}, "process_pid": 4340, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": []}], 
            [{'pid': 4700, 'image': 'C:\\Windows\\SysWOW64\\mshta.exe', 'timestamp': 1631560156.09572, 'guid': 'placeholder', 'ppid': 5696, 'command_line': '"C:\\Windows\\System32\\mshta.exe" C:\\Users\\buddy\\AppData\\Local\\Temp\\d0fd7acc38b3105facd6995344242f28e45f5384c0fdf2ec93ea24bfbc1dc9e6.hta', 'signatures': {'checks_debugger': 10}, 'process_pid': 4700, 'process_name': 'C:\\Windows\\SysWOW64\\mshta.exe', 'children': [], 'node_hash': '020a22f1742aa7a7b527a28940924abed6c55fff239c2277f2ba16e6ab497bd6'}, {'pid': 7812, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\ielowutil.exe', 'timestamp': 1631560157.731, 'guid': '{4e46ad60-a1dd-613f-c300-000000000c00}', 'ppid': 984, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\ielowutil.exe" -CLSID:{0002DF01-0000-0000-C000-000000000046} -Embedding', 'signatures': {}, 'process_pid': 7812, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\ielowutil.exe', 'children': [], 'node_hash': '6e461523d79e925776e8fd4fe1cbb3c919564a2064d36e23bc609cc2f84930b2'}, {'pid': 7568, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560157.769, 'guid': '{4e46ad60-a1dd-613f-c400-000000000c00}', 'ppid': 984, 'command_line': '"C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE" -Embedding', 'signatures': {}, 'process_pid': 7568, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [{'pid': 6520, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560158.302, 'guid': '{4e46ad60-a1de-613f-c500-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE" SCODEF:7568 CREDAT:17410 /prefetch:2', 'signatures': {}, 'process_pid': 6520, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'a29ba528ea47e781300820a3cc2db2dd788d949c7fb4d934fd6527e6504314b9'}, {'pid': 6680, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560158.792, 'guid': '{4e46ad60-a1de-613f-c600-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE" SCODEF:7568 CREDAT:82946 /prefetch:2', 'signatures': {}, 'process_pid': 6680, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'a29ba528ea47e781300820a3cc2db2dd788d949c7fb4d934fd6527e6504314b9'}, {'pid': 5920, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560159.309, 'guid': '{4e46ad60-a1df-613f-c700-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE" SCODEF:7568 CREDAT:17420 /prefetch:2', 'signatures': {}, 'process_pid': 5920, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'a29ba528ea47e781300820a3cc2db2dd788d949c7fb4d934fd6527e6504314b9'}, {'pid': 6040, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560159.498, 'guid': '{4e46ad60-a1df-613f-c800-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE" SCODEF:7568 CREDAT:17422 /prefetch:2', 'signatures': {}, 'process_pid': 6040, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'a29ba528ea47e781300820a3cc2db2dd788d949c7fb4d934fd6527e6504314b9'}, {'pid': 8000, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560159.573, 'guid': '{4e46ad60-a1df-613f-c900-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:123",', 'signatures': {}, 'process_pid': 8000, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 7164, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560159.715, 'guid': '{4e46ad60-a1df-613f-ca00-000000000c00}', 'ppid': 8000, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:123",', 'signatures': {}, 'process_pid': 7164, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 7456, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560160.127, 'guid': '{4e46ad60-a1e0-613f-cc00-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE" SCODEF:7568 CREDAT:82958 /prefetch:2', 'signatures': {}, 'process_pid': 7456, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'a29ba528ea47e781300820a3cc2db2dd788d949c7fb4d934fd6527e6504314b9'}, {'pid': 4808, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560160.446, 'guid': '{4e46ad60-a1e0-613f-d000-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE" SCODEF:7568 CREDAT:17424 /prefetch:2', 'signatures': {}, 'process_pid': 4808, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'a29ba528ea47e781300820a3cc2db2dd788d949c7fb4d934fd6527e6504314b9'}, {'pid': 6220, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560160.899, 'guid': '{4e46ad60-a1e0-613f-d100-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:123",', 'signatures': {}, 'process_pid': 6220, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 8012, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560161.084, 'guid': '{4e46ad60-a1e1-613f-d500-000000000c00}', 'ppid': 6220, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:123",', 'signatures': {}, 'process_pid': 8012, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 4768, 'image': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'timestamp': 1631560160.981, 'guid': '{4e46ad60-a1e0-613f-d300-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\Program Files (x86)\\Internet Explorer\\IEXPLORE.EXE" SCODEF:7568 CREDAT:82972 /prefetch:2', 'signatures': {}, 'process_pid': 4768, 'process_name': 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'a29ba528ea47e781300820a3cc2db2dd788d949c7fb4d934fd6527e6504314b9'}, {'pid': 5444, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560161.072, 'guid': '{4e46ad60-a1e1-613f-d400-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:123",', 'signatures': {}, 'process_pid': 5444, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 5952, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560161.633, 'guid': '{4e46ad60-a1e1-613f-d800-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:123",', 'signatures': {}, 'process_pid': 5952, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 7128, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560161.82, 'guid': '{4e46ad60-a1e1-613f-db00-000000000c00}', 'ppid': 5952, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:123",', 'signatures': {}, 'process_pid': 7128, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 5492, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560161.959, 'guid': '{4e46ad60-a1e1-613f-dd00-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../../AppData/Local/Temp/Low/championship.inf",', 'signatures': {}, 'process_pid': 5492, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 8044, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560162.153, 'guid': '{4e46ad60-a1e2-613f-e000-000000000c00}', 'ppid': 5492, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../../AppData/Local/Temp/Low/championship.inf",', 'signatures': {}, 'process_pid': 8044, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 5460, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560162.141, 'guid': '{4e46ad60-a1e2-613f-df00-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../../AppData/Local/Temp/championship.inf",', 'signatures': {}, 'process_pid': 5460, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 6508, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560162.375, 'guid': '{4e46ad60-a1e2-613f-e200-000000000c00}', 'ppid': 5460, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../../AppData/Local/Temp/championship.inf",', 'signatures': {}, 'process_pid': 6508, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 8020, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560162.284, 'guid': '{4e46ad60-a1e2-613f-e100-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../../../AppData/Local/Temp/Low/championship.inf",', 'signatures': {}, 'process_pid': 8020, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 7740, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560162.413, 'guid': '{4e46ad60-a1e2-613f-e300-000000000c00}', 'ppid': 8020, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../../../AppData/Local/Temp/Low/championship.inf",', 'signatures': {}, 'process_pid': 7740, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 5624, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560162.446, 'guid': '{4e46ad60-a1e2-613f-e400-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../../../AppData/Local/Temp/championship.inf",', 'signatures': {}, 'process_pid': 5624, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 4956, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560162.576, 'guid': '{4e46ad60-a1e2-613f-e500-000000000c00}', 'ppid': 5624, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../../../AppData/Local/Temp/championship.inf",', 'signatures': {}, 'process_pid': 4956, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 7104, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560162.593, 'guid': '{4e46ad60-a1e2-613f-e600-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../../../../Temp/Low/championship.inf",', 'signatures': {}, 'process_pid': 7104, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 7360, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560162.772, 'guid': '{4e46ad60-a1e2-613f-e800-000000000c00}', 'ppid': 7104, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../../../../Temp/Low/championship.inf",', 'signatures': {}, 'process_pid': 7360, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 6052, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560162.714, 'guid': '{4e46ad60-a1e2-613f-e700-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../../../../Temp/championship.inf",', 'signatures': {}, 'process_pid': 6052, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 7308, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560162.852, 'guid': '{4e46ad60-a1e2-613f-e900-000000000c00}', 'ppid': 6052, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../../../../Temp/championship.inf",', 'signatures': {}, 'process_pid': 7308, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 6952, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560162.929, 'guid': '{4e46ad60-a1e2-613f-ea00-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../Low/championship.inf",', 'signatures': {}, 'process_pid': 6952, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 7552, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560163.148, 'guid': '{4e46ad60-a1e3-613f-ec00-000000000c00}', 'ppid': 6952, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../Low/championship.inf",', 'signatures': {}, 'process_pid': 7552, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}, {'pid': 7148, 'image': 'C:\\Windows\\System32\\control.exe', 'timestamp': 1631560163.052, 'guid': '{4e46ad60-a1e3-613f-eb00-000000000c00}', 'ppid': 7568, 'command_line': '"C:\\WINDOWS\\System32\\control.exe" ".cpl:../../championship.inf",', 'signatures': {}, 'process_pid': 7148, 'process_name': 'C:\\Windows\\System32\\control.exe', 'children': [{'pid': 5448, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560163.178, 'guid': '{4e46ad60-a1e3-613f-ed00-000000000c00}', 'ppid': 7148, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:../../championship.inf",', 'signatures': {}, 'process_pid': 5448, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': 'c0d3c6cb57e3fdf4a10aace42fbd21151d8d308aaee42758a95287605df9c3f7'}], 'node_hash': '8c51a7189c974db6447ebd25980a9581ca14183da2e2e0582cb6ddddaddf071b'}], 'node_hash': '4254ed6b974270c984db5307dac954f17eac79d461d08fca8fd2d32e71b67397'}, {'pid': 4388, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560160.382, 'guid': '{4e46ad60-a1e0-613f-cf00-000000000c00}', 'ppid': 5444, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:123",', 'signatures': {}, 'process_pid': 4388, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': '3a0586cf75968d78d00a3c8c95491e6055aefe6151242caaae3536077e12027a'}, {'pid': 7100, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560161.836, 'guid': '{4e46ad60-a1e1-613f-dc00-000000000c00}', 'ppid': 7360, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:123",', 'signatures': {}, 'process_pid': 7100, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': '3a0586cf75968d78d00a3c8c95491e6055aefe6151242caaae3536077e12027a'}, {'pid': 4648, 'image': 'C:\\Windows\\System32\\rundll32.exe', 'timestamp': 1631560162.074, 'guid': '{4e46ad60-a1e2-613f-de00-000000000c00}', 'ppid': 5448, 'command_line': '"C:\\WINDOWS\\system32\\rundll32.exe" Shell32.dll,Control_RunDLL ".cpl:123",', 'signatures': {}, 'process_pid': 4648, 'process_name': 'C:\\Windows\\System32\\rundll32.exe', 'children': [], 'node_hash': '3a0586cf75968d78d00a3c8c95491e6055aefe6151242caaae3536077e12027a'}, {'pid': 1060, 'image': 'C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe', 'timestamp': 1631560207.708, 'guid': '{4e46ad60-a20f-613f-ef00-000000000c00}', 'ppid': 984, 'command_line': '"C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe" -ServerName:Hx.IPC.Server', 'signatures': {}, 'process_pid': 1060, 'process_name': 'C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_16005.11629.20316.0_x64__8wekyb3d8bbwe\\HxTsr.exe', 'children': [], 'node_hash': 'eea01420e00bd1b9628ff606567c6bfba498f3c528588896b4c5b2df0a0adb2a'}, {'pid': 1396, 'image': 'C:\\Windows\\System32\\backgroundTaskHost.exe', 'timestamp': 1631560207.711, 'guid': '{4e46ad60-a20f-613f-f000-000000000c00}', 'ppid': 984, 'command_line': '"C:\\WINDOWS\\system32\\backgroundTaskHost.exe" -ServerName:App.AppXmtcan0h2tfbfy7k9kn8hbxb6dmzz1zh0.mca', 'signatures': {}, 'process_pid': 1396, 'process_name': 'C:\\Windows\\System32\\backgroundTaskHost.exe', 'children': [], 'node_hash': '290242d7b8fb826c24c48208819149c9c1651234601116b6eb80086c49291930'}, {'pid': 2908, 'image': 'C:\\Windows\\System32\\RuntimeBroker.exe', 'timestamp': 1631560207.928, 'guid': '{4e46ad60-a20f-613f-f100-000000000c00}', 'ppid': 984, 'command_line': 'C:\\Windows\\System32\\RuntimeBroker.exe -Embedding', 'signatures': {}, 'process_pid': 2908, 'process_name': 'C:\\Windows\\System32\\RuntimeBroker.exe', 'children': [], 'node_hash': '6e06b06abb69086464746156b313bb85e792314ef5bb5f92faec74e6f48a66f1'}, {'pid': 4340, 'image': 'C:\\Windows\\System32\\svchost.exe', 'timestamp': 1631560219.817, 'guid': '{4e46ad60-a21b-613f-f200-000000000c00}', 'ppid': 780, 'command_line': 'C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p -s BITS', 'signatures': {}, 'process_pid': 4340, 'process_name': 'C:\\Windows\\System32\\svchost.exe', 'children': [], 'node_hash': '61ed4f85c992073bf9cf86a8ccf97a3836235b3026eee472b11bdd9eb577ed2a'}],
            ['a5c5fc30ffa1a737420a961aed07a070f33e0391fd895a8f84b6e0051e06fefe', 'e5aacf84d00ab6b4f186e9de3d764471da4636ed8f3b3d6985b774e8611fbb47', '6a1f92fc1536ae5a9fccec23b73c488dd3adb275695c9cff23426d7c271d475a', '57653c440c3a6271e4125b801455effd4b6afcf7018f413180ad66cd3f443463', '57653c440c3a6271e4125b801455effd4b6afcf7018f413180ad66cd3f443463', '57653c440c3a6271e4125b801455effd4b6afcf7018f413180ad66cd3f443463', '91944a6f3ab216be112650200704d070eff8921edeec7dc9fe06a048aaa70e7d', 'd61610c9578de6b2ccc7062a56f06bdbee06f9a5533611367b4c1e1533e0d3c4', '643944c5cf7a9b9f956b6ac6f2a36c35750ee883a33ac514ef5d118e73ec8530', '13d002167decebba0b409eadd14efcc27248c12b0ec9d52012506c9417efd9a8']),
            ([{"pid": 7888, "image": "C:\\Program Files (x86)\\Adobe\\Reader 11.0\\Reader\\AcroRd32.exe", "timestamp": 1631559681.568417, "guid": "placeholder", "ppid": 7876, "command_line": "\"C:\\Program Files (x86)\\Adobe\\Reader 11.0\\Reader\\AcroRd32.exe\" \"C:\\Users\\buddy\\AppData\\Local\\Temp\\Rodriguez Nelson.pdf\"", "signatures": {"injection_resumethread": 250}, "process_pid": 7888, "process_name": "C:\\Program Files (x86)\\Adobe\\Reader 11.0\\Reader\\AcroRd32.exe", "children": [ {"pid": 7496, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559683.496, "guid": "{4e46ad60-a003-613f-ea03-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7496, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4356, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559684.992, "guid": "{4e46ad60-a004-613f-f003-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4356, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1920, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559688.906, "guid": "{4e46ad60-a008-613f-f503-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1920, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1288, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559694.325, "guid": "{4e46ad60-a00e-613f-fc03-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1288, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1876, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559701.97, "guid": "{4e46ad60-a015-613f-0104-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1876, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 8124, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559704.158, "guid": "{4e46ad60-a018-613f-0604-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 8124, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4916, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559706.333, "guid": "{4e46ad60-a01a-613f-0b04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4916, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1700, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559710.698, "guid": "{4e46ad60-a01e-613f-1004-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1700, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 8080, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559712.873, "guid": "{4e46ad60-a020-613f-1504-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 8080, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1056, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559717.214, "guid": "{4e46ad60-a025-613f-1a04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1056, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 6512, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559718.297, "guid": "{4e46ad60-a026-613f-1f04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 6512, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1504, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559721.542, "guid": "{4e46ad60-a029-613f-2404-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1504, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4600, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559723.747, "guid": "{4e46ad60-a02b-613f-2904-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4600, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7736, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559724.828, "guid": "{4e46ad60-a02c-613f-2e04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7736, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 8000, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559727.045, "guid": "{4e46ad60-a02f-613f-3304-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 8000, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 5900, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559728.122, "guid": "{4e46ad60-a030-613f-3804-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 5900, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7840, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559734.643, "guid": "{4e46ad60-a036-613f-3d04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7840, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7328, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559736.827, "guid": "{4e46ad60-a038-613f-4204-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7328, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1496, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559737.911, "guid": "{4e46ad60-a039-613f-4704-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1496, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 2460, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559738.999, "guid": "{4e46ad60-a03a-613f-4c04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 2460, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 3988, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559740.087, "guid": "{4e46ad60-a03c-613f-5104-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 3988, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7536, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559742.26, "guid": "{4e46ad60-a03e-613f-5604-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7536, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7460, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559743.35, "guid": "{4e46ad60-a03f-613f-5b04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7460, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1772, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559748.815, "guid": "{4e46ad60-a044-613f-6004-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1772, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 6200, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559749.924, "guid": "{4e46ad60-a045-613f-6504-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 6200, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1372, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559754.326, "guid": "{4e46ad60-a04a-613f-6a04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1372, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 2676, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559755.407, "guid": "{4e46ad60-a04b-613f-6f04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 2676, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 8100, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559758.681, "guid": "{4e46ad60-a04e-613f-7404-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 8100, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4904, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559759.769, "guid": "{4e46ad60-a04f-613f-7904-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4904, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1196, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559764.175, "guid": "{4e46ad60-a054-613f-7e04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1196, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4988, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559773.961, "guid": "{4e46ad60-a05d-613f-8304-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4988, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4304, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559775.044, "guid": "{4e46ad60-a05f-613f-8804-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4304, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 3752, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559776.136, "guid": "{4e46ad60-a060-613f-8d04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 3752, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4880, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559779.429, "guid": "{4e46ad60-a063-613f-9204-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4880, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7128, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559781.606, "guid": "{4e46ad60-a065-613f-9704-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7128, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7404, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559784.918, "guid": "{4e46ad60-a068-613f-9c04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7404, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 1316, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559787.084, "guid": "{4e46ad60-a06b-613f-a104-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 1316, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 6280, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559789.253, "guid": "{4e46ad60-a06d-613f-a604-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 6280, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4268, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559790.336, "guid": "{4e46ad60-a06e-613f-ab04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4268, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 6716, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559792.511, "guid": "{4e46ad60-a070-613f-b004-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 6716, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 3412, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559793.6, "guid": "{4e46ad60-a071-613f-b504-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 3412, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 2236, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559794.69, "guid": "{4e46ad60-a072-613f-ba04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 2236, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 2728, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559796.905, "guid": "{4e46ad60-a074-613f-bf04-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 2728, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 4588, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559799.108, "guid": "{4e46ad60-a077-613f-c404-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 4588, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}, {"pid": 7896, "image": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "timestamp": 1631559801.274, "guid": "{4e46ad60-a079-613f-c904-000000000c00}", "ppid": 7888, "command_line": "\"C:\\Program Files\\Internet Explorer\\iexplore.exe\" https://evil.com", "signatures": {}, "process_pid": 7896, "process_name": "C:\\Program Files\\Internet Explorer\\iexplore.exe", "children": []}]}], [{'pid': 7888, 'image': 'C:\\Program Files (x86)\\Adobe\\Reader 11.0\\Reader\\AcroRd32.exe', 'timestamp': 1631559681.568417, 'guid': 'placeholder', 'ppid': 7876, 'command_line': '"C:\\Program Files (x86)\\Adobe\\Reader 11.0\\Reader\\AcroRd32.exe" "C:\\Users\\buddy\\AppData\\Local\\Temp\\Rodriguez Nelson.pdf"', 'signatures': {'injection_resumethread': 250}, 'process_pid': 7888, 'process_name': 'C:\\Program Files (x86)\\Adobe\\Reader 11.0\\Reader\\AcroRd32.exe', 'children': [{'pid': 7496, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559683.496, 'guid': '{4e46ad60-a003-613f-ea03-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7496, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4356, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559684.992, 'guid': '{4e46ad60-a004-613f-f003-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4356, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1920, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559688.906, 'guid': '{4e46ad60-a008-613f-f503-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1920, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1288, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559694.325, 'guid': '{4e46ad60-a00e-613f-fc03-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1288, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1876, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559701.97, 'guid': '{4e46ad60-a015-613f-0104-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1876, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 8124, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559704.158, 'guid': '{4e46ad60-a018-613f-0604-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 8124, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4916, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559706.333, 'guid': '{4e46ad60-a01a-613f-0b04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4916, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1700, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559710.698, 'guid': '{4e46ad60-a01e-613f-1004-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1700, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 8080, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559712.873, 'guid': '{4e46ad60-a020-613f-1504-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 8080, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1056, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559717.214, 'guid': '{4e46ad60-a025-613f-1a04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1056, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 6512, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559718.297, 'guid': '{4e46ad60-a026-613f-1f04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 6512, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1504, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559721.542, 'guid': '{4e46ad60-a029-613f-2404-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1504, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4600, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559723.747, 'guid': '{4e46ad60-a02b-613f-2904-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4600, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7736, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559724.828, 'guid': '{4e46ad60-a02c-613f-2e04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7736, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 8000, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559727.045, 'guid': '{4e46ad60-a02f-613f-3304-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 8000, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 5900, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559728.122, 'guid': '{4e46ad60-a030-613f-3804-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 5900, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7840, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559734.643, 'guid': '{4e46ad60-a036-613f-3d04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7840, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7328, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559736.827, 'guid': '{4e46ad60-a038-613f-4204-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7328, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1496, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559737.911, 'guid': '{4e46ad60-a039-613f-4704-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1496, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 2460, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559738.999, 'guid': '{4e46ad60-a03a-613f-4c04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 2460, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 3988, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559740.087, 'guid': '{4e46ad60-a03c-613f-5104-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 3988, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7536, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559742.26, 'guid': '{4e46ad60-a03e-613f-5604-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7536, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7460, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559743.35, 'guid': '{4e46ad60-a03f-613f-5b04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7460, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1772, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559748.815, 'guid': '{4e46ad60-a044-613f-6004-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1772, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 6200, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559749.924, 'guid': '{4e46ad60-a045-613f-6504-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 6200, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1372, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559754.326, 'guid': '{4e46ad60-a04a-613f-6a04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1372, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 2676, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559755.407, 'guid': '{4e46ad60-a04b-613f-6f04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 2676, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 8100, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559758.681, 'guid': '{4e46ad60-a04e-613f-7404-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 8100, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4904, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559759.769, 'guid': '{4e46ad60-a04f-613f-7904-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4904, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1196, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559764.175, 'guid': '{4e46ad60-a054-613f-7e04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1196, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4988, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559773.961, 'guid': '{4e46ad60-a05d-613f-8304-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4988, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4304, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559775.044, 'guid': '{4e46ad60-a05f-613f-8804-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4304, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 3752, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559776.136, 'guid': '{4e46ad60-a060-613f-8d04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 3752, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4880, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559779.429, 'guid': '{4e46ad60-a063-613f-9204-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4880, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7128, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559781.606, 'guid': '{4e46ad60-a065-613f-9704-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7128, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7404, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559784.918, 'guid': '{4e46ad60-a068-613f-9c04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7404, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 1316, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559787.084, 'guid': '{4e46ad60-a06b-613f-a104-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 1316, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 6280, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559789.253, 'guid': '{4e46ad60-a06d-613f-a604-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 6280, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4268, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559790.336, 'guid': '{4e46ad60-a06e-613f-ab04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4268, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 6716, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559792.511, 'guid': '{4e46ad60-a070-613f-b004-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 6716, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 3412, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559793.6, 'guid': '{4e46ad60-a071-613f-b504-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 3412, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 2236, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559794.69, 'guid': '{4e46ad60-a072-613f-ba04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 2236, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 2728, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559796.905, 'guid': '{4e46ad60-a074-613f-bf04-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 2728, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 4588, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559799.108, 'guid': '{4e46ad60-a077-613f-c404-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 4588, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}, {'pid': 7896, 'image': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'timestamp': 1631559801.274, 'guid': '{4e46ad60-a079-613f-c904-000000000c00}', 'ppid': 7888, 'command_line': '"C:\\Program Files\\Internet Explorer\\iexplore.exe" https://evil.com', 'signatures': {}, 'process_pid': 7896, 'process_name': 'C:\\Program Files\\Internet Explorer\\iexplore.exe', 'children': [], 'node_hash': 'e1dc7e6756f6aa7dbbe7498e126c4c4dc9d607a3272b4b0f15c4ca076f2c1105'}], 'node_hash': '5e69d13e716a4309d163a6938797987ca656380825f38712883c7309f3ce3aef'}], ['da2892716d00fa501fb5f4ed97d96adcce18899ff47f2ae64fcab9856a856dc5']),
        ]
    )
    def test_create_hashes(process_tree, expected_process_tree, expected_process_tree_hashes):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        hashes = SandboxOntology._create_hashes(process_tree, 'root')

        for x in range(len(hashes)):
            assert hashes[x] == expected_process_tree_hashes[x]
        
        assert process_tree == expected_process_tree

    @staticmethod
    @pytest.mark.parametrize(
        'process_tree, expected_leaf_hashes',
        [ 
            ([{ "pid": 7100, "image": "C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE", "timestamp": 1631903280.208475, "guid": "placeholder", "ppid": 2528, "command_line": "\"C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE\" C:\\Users\\buddy\\AppData\\Local\\Temp\\3617524f469002f54459d47e97fe757661b4e7a776b04cbfab50e746d779a31c.xls", "signatures": { "stealth_window": 100, "injection_resumethread": 250 }, "process_pid": 7100, "process_name": "C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE", "children": [ { "pid": 5036, "image": "C:\\Windows\\SysWOW64\\cmd.exe", "timestamp": 1631903284.061, "guid": "{4e46ad60-de34-6144-d803-000000000c00}", "ppid": 7100, "command_line": "\"C:\\Windows\\System32\\cmd.exe\" /C PO^W^ers^HE^lL -E somebase64=", "signatures": { "injection_resumethread": 250 }, "process_pid": 5036, "process_name": "C:\\Windows\\SysWOW64\\cmd.exe", "children": [ { "pid": 4796, "image": "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe", "timestamp": 1631903284.377, "guid": "{4e46ad60-de34-6144-dc03-000000000c00}", "ppid": 5036, "command_line": "POWersHElL  -E somebase64=", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "privilege_luid_check": 100, "injection_resumethread": 250 }, "process_pid": 4796, "process_name": "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe", "children": [ { "pid": 4832, "image": "C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe", "timestamp": 1631903312.724, "guid": "{4e46ad60-de50-6144-e103-000000000c00}", "ppid": 4796, "command_line": "\"C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe\"", "signatures": {}, "process_pid": 4832, "process_name": "C:\\Users\\buddy\\AppData\\Local\\Temp\\ipa.exe", "children": [] } ] } ] } ] }, { "pid": 1356, "image": "C:\\Windows\\System32\\svchost.exe", "timestamp": 1631903307.569, "guid": "{4e46ad60-de4b-6144-e003-000000000c00}", "ppid": 764, "command_line": "C:\\WINDOWS\\System32\\svchost.exe -k netsvcs -p -s BITS", "signatures": {}, "process_pid": 1356, "process_name": "C:\\Windows\\System32\\svchost.exe", "children": []}], [['7e7b9840296dd1b624095faa63388eddf31cea89180fe7d6e4eb01fd52ab14b9'], ['61ed4f85c992073bf9cf86a8ccf97a3836235b3026eee472b11bdd9eb577ed2a']]),
            ([{"pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": {"injection_resumethread": 250}, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic1.exe", "timestamp": 1631203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic11.exe", "timestamp": 1631203138.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic111.exe", "timestamp": 1631303128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}]}, {"pid": 6400, "image": "?sys32\\wbem\\wmic12.exe", "timestamp": 1631203148.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}]}, {"pid": 6400, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}, {"pid": 6400, "image": "?sys32\\wbem\\wmic3.exe", "timestamp": 1633203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ {"pid": 6400, "image": "?sys32\\wbem\\wmic31.exe", "timestamp": 1634203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}, {"pid": 6400, "image": "?sys32\\wbem\\wmic32.exe", "timestamp": 1635203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}, {"pid": 6400, "image": "?sys32\\wbem\\wmic33.exe", "timestamp": 1636203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": {"antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100}, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": []}]}]}], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']])
        ]
    )
    def test_create_leaf_hashes(process_tree, expected_leaf_hashes):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology

        assert SandboxOntology._create_hashes(process_tree, 'leaf') == expected_leaf_hashes

    @staticmethod
    @pytest.mark.parametrize(
        'node, leaf_hashes, safe_leaf_hashes, expected_node',
        [ 
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] } ] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d'], { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }),
            ({ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, 
            ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], 
            { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": []}),
        ]
    )
    def test_remove_safe_leaves_helper(node, leaf_hashes, safe_leaf_hashes, expected_node):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology

        SandboxOntology._remove_safe_leaves_helper(node, leaf_hashes, safe_leaf_hashes)
        assert node == expected_node

    @staticmethod
    @pytest.mark.parametrize(
        'process_tree, leaf_hashes, safe_leaf_hashes, expected_process_tree',
        [
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] } ] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }]),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], []),
            ([{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }, { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "children": [ { "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] }, { "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "children": [] }, { "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "children": [] } ] } ] }], [['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d', 'a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b', '6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5']], ['63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac', '099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd', '4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5'], [{ "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] } ] } ] }, { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] } ] } ] }, { "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "children": [ { "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "children": [ { "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "children": [] } ] }, { "image": "?sys32\\wbem\\wmic2.exe", "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "children": [] }, { "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "children": [ { "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "children": [] } ] } ] }])
        ]
    )
    def test_remove_safe_leaves(process_tree, leaf_hashes, safe_leaf_hashes, expected_process_tree):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology

        SandboxOntology._remove_safe_leaves(process_tree, leaf_hashes, safe_leaf_hashes)

        assert process_tree == expected_process_tree

    @staticmethod
    @pytest.mark.parametrize(
        "process_tree, safe_leaf_hashes, expected_process_tree",
        [
            ([{ "pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": { "injection_resumethread": 250 }, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "timestamp": 1631203138.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "timestamp": 1631303128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "timestamp": 1631203148.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "timestamp": 1633203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "timestamp": 1634203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "timestamp": 1635203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "timestamp": 1636203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] } ] }], ["63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5"], []),
            ([{ "pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": { "injection_resumethread": 250 }, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "timestamp": 1631203138.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "timestamp": 1631303128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "timestamp": 1631203148.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "timestamp": 1633203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "timestamp": 1634203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "timestamp": 1635203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "timestamp": 1636203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] } ] }], ["6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5"], [{ "pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": { "injection_resumethread": 250 }, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "timestamp": 1631203138.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "timestamp": 1631303128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "timestamp": 1631203148.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }]}]),
            ([{ "pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": { "injection_resumethread": 250 }, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic1.exe", "node_hash": "444ba8aca3c500c14d6b9948e6564864ffe3533b17c8a7970b20ff4145884448", "timestamp": 1631203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic11.exe", "node_hash": "29ee5e07066a9f5c9f66856c8cadaf706439b1eaef79ddad74f3cac929b54464", "timestamp": 1631203138.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic111.exe", "node_hash": "63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "timestamp": 1631303128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic12.exe", "node_hash": "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "timestamp": 1631203148.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic2.exe", "timestamp": 1632203128.413, "node_hash": "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b", "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "timestamp": 1633203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "timestamp": 1634203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "timestamp": 1635203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "timestamp": 1636203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] } ] }], ["63f4a4e5d1d649916ae2088bb28c3356b2348184c4dd332907e5498232da71ac", "6943c25c391d6dd1f87670f5135c621d3b30b05e211074225a92da65591ef38d", "a919e092d0d0149ce706c801290feabe3dc392d41283c9b575e6d1f0026bad1b"], [{ "pid": 8036, "image": "?pf86\\microsoft office\\office14\\excel.exe", "node_hash": "e0e3b025c75e49d9306866f83a77c0356d825e25b1f4fc6ddbaf6339d3a22c62", "timestamp": 1631203119.713387, "guid": "placeholder", "ppid": 6452, "command_line": "\"?pf86\\microsoft office\\office14\\excel.exe\" C:\\Users\\buddy\\AppData\\Local\\Temp\\5d3c9aebb0cae9d71e339df6dda52da6679ea1b95090eb51c66032f93516e800.xls", "signatures": { "injection_resumethread": 250 }, "process_pid": 8036, "process_name": "?pf86\\microsoft office\\office14\\excel.exe", "children": [{ "pid": 6400, "image": "?sys32\\wbem\\wmic3.exe", "node_hash": "878e93a9cb19e3d8d659dbb3bd4945e53055f3b22c79ac49fac3070b3cc1acd7", "timestamp": 1633203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [ { "pid": 6400, "image": "?sys32\\wbem\\wmic31.exe", "node_hash": "6efb85adcc57520a6b6b72afaba81d82c5deae025761f98aa33125cb37274b40", "timestamp": 1634203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic32.exe", "node_hash": "099dc238ab64fb47b78557f727aa3a38a7c8b74c395c7010dd3bd2a63ec7ebdd", "timestamp": 1635203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] }, { "pid": 6400, "image": "?sys32\\wbem\\wmic33.exe", "node_hash": "4e99297d75424090c9b9c02fd62d19835e9ae15d3aa137ae3eab1b3c83088fa5", "timestamp": 1636203128.413, "guid": "{4e46ad60-2f38-613a-c200-000000000c00}", "ppid": 8036, "command_line": "wmic process call create 'mshta ?c\\programdata\\svyabothbrr.sct'", "signatures": { "antivm_queries_computername": 10, "checks_debugger": 10, "antivm_disk_size": 100 }, "process_pid": 6400, "process_name": "?sys32\\wbem\\wmic.exe", "children": [] } ] } ] }]),
        ]
    )
    def test_filter_process_tree_against_safe_hashes(process_tree, safe_leaf_hashes, expected_process_tree):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        filtered_process_tree = SandboxOntology._filter_process_tree_against_safe_hashes(process_tree, safe_leaf_hashes)
        assert filtered_process_tree == expected_process_tree

    @staticmethod
    @pytest.mark.parametrize("events, expected_result",
        [
            (None, []),
            ([], []),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}], [{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}]),
            ([{"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}], [{"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}]),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}, {"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}], [{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}, {"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}]),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}, {"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 2.0, "guid": "blah"}], [{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 1.0, "guid": "blah", "pguid": "blah"}, {"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 2.0, "guid": "blah"}]),
            ([{"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2.0, "guid": "blah", "pguid": "blah"}, {"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}], [{"protocol": "blah", "src_ip": "blah", "src_port": 1, "domain": "blah", "dest_ip": "blah", "dest_port": 1, "pid": 1, "image": "blah", "timestamp": 1.0, "guid": "blah"}, {"pid": 1, "ppid": 1, "image": "blah", "command_line": "blah", "timestamp": 2.0, "guid": "blah", "pguid": "blah"}]),
        ]
    )
    def test_get_events(events, expected_result):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        so = SandboxOntology(events=events)
        actual_result = so.get_events()
        assert actual_result == expected_result

    # TODO: implement this
    # @staticmethod
    # def test_run_signatures():
    #     from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
    #     o = SandboxOntology()
    #     actual_result = o.run_signatures()
    #     assert actual_result is True

    @staticmethod
    @pytest.mark.parametrize("artifact_list, expected_result",
        [
            (None, None),
            ([], None),
            ([{"name": "blah", "path": "blah", "description": "blah", "to_be_extracted": True}], None),
            ([{"name": "blah", "path": "blah", "description": "blah", "to_be_extracted": False}], None),
        ]
    )
    def test_handle_artifacts(artifact_list, expected_result, dummy_request_class):
        from assemblyline_v4_service.common.dynamic_service_helper import SandboxOntology
        r = dummy_request_class()
        o = SandboxOntology()
        actual_result = o.handle_artifacts(artifact_list, r)
        assert actual_result == expected_result

